from aiogram import Bot, Dispatcher, types
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton
from aiogram.utils import executor

API_TOKEN = 'YOUR_BOT_TOKEN_HERE'

bot = Bot(token=API_TOKEN)
dp = Dispatcher(bot)

user_data = {}

professions = {
    '–∏–Ω–∂–µ–Ω–µ—Ä': 0,
    '–∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å': 0,
    '—É—á–∏—Ç–µ–ª—å': 0,
    '–ø–∞—Ä—Ç–∏–π–Ω—ã–π –¥–µ—è—Ç–µ–ª—å': 0,
    '–ø–∏—Å–∞—Ç–µ–ª—å': 0,
    '–∞—Ä—Ç–∏—Å—Ç': 0,
    '—à–∞—Ö—Ç—ë—Ä': 0,
    '–∫–æ–ª—Ö–æ–∑–Ω–∏–∫': 0,
    '–≤—Ä–∞—á': 0,
    '–≤–æ–µ–Ω–Ω—ã–π': 0,
    '—É—á—ë–Ω—ã–π': 0,
    '—Ñ–∞–±—Ä–∏—á–Ω—ã–π —Ä–∞–±–æ—á–∏–π': 0,
    '–º–∏–ª–∏—Ü–∏–æ–Ω–µ—Ä': 0,
    '–ª—ë—Ç—á–∏–∫': 0,
    '–¥–∏–ø–ª–æ–º–∞—Ç': 0
}

questions = [
    {
        "text": "–¢—ã —Å–∫–æ—Ä–µ–µ...",
        "options": [
            ("–õ—é–±–ª—é –∏–∑–æ–±—Ä–µ—Ç–∞—Ç—å –∏ —á–∏–Ω–∏—Ç—å", {"–∏–Ω–∂–µ–Ω–µ—Ä": 2, "–∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å": 1}),
            ("–û–±—â–∞—é—Å—å —Å –ª—é–¥—å–º–∏ –∏ —Ä—É–∫–æ–≤–æ–∂—É", {"—É—á–∏—Ç–µ–ª—å": 2, "–ø–∞—Ä—Ç–∏–π–Ω—ã–π –¥–µ—è—Ç–µ–ª—å": 1}),
            ("–ú–µ—á—Ç–∞—é –∏ —Å–æ–∑–¥–∞—é –∏—Å–∫—É—Å—Å—Ç–≤–æ", {"–ø–∏—Å–∞—Ç–µ–ª—å": 2, "–∞—Ä—Ç–∏—Å—Ç": 1}),
            ("–†–∞–±–æ—Ç–∞—é —Ä—É–∫–∞–º–∏, –º–Ω–µ –Ω–µ —Å—Ç—Ä–∞—à–µ–Ω —Ç—Ä—É–¥", {"—à–∞—Ö—Ç—ë—Ä": 2, "–∫–æ–ª—Ö–æ–∑–Ω–∏–∫": 1}),
        ]
    },
    {
        "text": "–ß—Ç–æ —Ç–µ–±–µ –±–ª–∏–∂–µ –ø–æ –¥—É—Ö—É?",
        "options": [
            ("–°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", {"–∏–Ω–∂–µ–Ω–µ—Ä": 2, "—É—á—ë–Ω—ã–π": 1}),
            ("–ü–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º", {"–≤—Ä–∞—á": 2, "—É—á–∏—Ç–µ–ª—å": 1}),
            ("–°–ª—É–∂–∏—Ç—å —Å—Ç—Ä–∞–Ω–µ", {"–≤–æ–µ–Ω–Ω—ã–π": 2, "–º–∏–ª–∏—Ü–∏–æ–Ω–µ—Ä": 1}),
            ("–¢–≤–æ—Ä–∏—Ç—å –Ω–∞ —Å—Ü–µ–Ω–µ –∏–ª–∏ –≤ –∫–Ω–∏–≥–∞—Ö", {"–∞—Ä—Ç–∏—Å—Ç": 2, "–ø–∏—Å–∞—Ç–µ–ª—å": 1}),
        ]
    },
    {
        "text": "–ö–∞–∫–æ–π —Å—Ç–∏–ª—å —Ä–∞–±–æ—Ç—ã —Ç–µ–±–µ –±–ª–∏–∂–µ?",
        "options": [
            ("–°—Ç–∞–±–∏–ª—å–Ω–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è", {"—Ñ–∞–±—Ä–∏—á–Ω—ã–π —Ä–∞–±–æ—á–∏–π": 2, "–∫–æ–ª—Ö–æ–∑–Ω–∏–∫": 1}),
            ("–ü–æ–ª–Ω–∞—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç–µ–π", {"–ª—ë—Ç—á–∏–∫": 2, "–≤–æ–µ–Ω–Ω—ã–π": 1}),
            ("–°–≤—è–∑–∞–Ω–∞ —Å –≤–ª–∏—è–Ω–∏–µ–º", {"–ø–∞—Ä—Ç–∏–π–Ω—ã–π –¥–µ—è—Ç–µ–ª—å": 2, "–¥–∏–ø–ª–æ–º–∞—Ç": 1}),
            ("–ù–∞—É—á–Ω–∞—è –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è", {"—É—á—ë–Ω—ã–π": 2, "–∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å": 1}),
        ]
    },
    {
        "text": "–ö–∞–∫–∞—è —Å—Ñ–µ—Ä–∞ —Ç–µ–±–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–µ–µ?",
        "options": [
            ("–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å", {"–∏–Ω–∂–µ–Ω–µ—Ä": 2, "—Ñ–∞–±—Ä–∏—á–Ω—ã–π —Ä–∞–±–æ—á–∏–π": 1}),
            ("–°–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ", {"–∫–æ–ª—Ö–æ–∑–Ω–∏–∫": 2, "–≤—Ä–∞—á": 1}),
            ("–ö—É–ª—å—Ç—É—Ä–∞", {"–ø–∏—Å–∞—Ç–µ–ª—å": 2, "–∞—Ä—Ç–∏—Å—Ç": 1}),
            ("–ü–æ–ª–∏—Ç–∏–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", {"–¥–∏–ø–ª–æ–º–∞—Ç": 2, "–ø–∞—Ä—Ç–∏–π–Ω—ã–π –¥–µ—è—Ç–µ–ª—å": 1}),
        ]
    }
]

@dp.message_handler(commands=['start'])
async def start(message: types.Message):
    user_data[message.from_user.id] = {"step": 0, "scores": professions.copy()}
    await send_question(message.from_user.id)

async def send_question(user_id):
    step = user_data[user_id]["step"]
    if step < len(questions):
        q = questions[step]
        kb = ReplyKeyboardMarkup(resize_keyboard=True)
        for option, _ in q["options"]:
            kb.add(KeyboardButton(option))
        await bot.send_message(user_id, q["text"], reply_markup=kb)
    else:
        await show_result(user_id)

@dp.message_handler()
async def handle_answer(message: types.Message):
    user_id = message.from_user.id
    step = user_data[user_id]["step"]
    q = questions[step]

    for option, scores in q["options"]:
        if message.text == option:
            for prof, pts in scores.items():
                user_data[user_id]["scores"][prof] += pts
            break

    user_data[user_id]["step"] += 1
    await send_question(user_id)

async def show_result(user_id):
    scores = user_data[user_id]["scores"]
    top_prof = max(scores, key=scores.get)
    history = {
        "–∏–Ω–∂–µ–Ω–µ—Ä": "–ò–Ω–∂–µ–Ω–µ—Ä—ã XX –≤–µ–∫–∞ —Å–æ–∑–¥–∞–≤–∞–ª–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Å—Ç—Ä–æ–∏–ª–∏ –∑–∞–≤–æ–¥—ã. –û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —É–≤–∞–∂–∞–µ–º—ã—Ö –∏ –Ω—É–∂–Ω—ã—Ö –ª—é–¥–µ–π —ç–ø–æ—Ö–∏.",
        "—É—á–∏—Ç–µ–ª—å": "–£—á–∏—Ç–µ–ª—è –±—ã–ª–∏ –≤–∞–∂–Ω–µ–π—à–∏–º –∑–≤–µ–Ω–æ–º —Å–æ–≤–µ—Ç—Å–∫–æ–≥–æ –æ–±—â–µ—Å—Ç–≤–∞, —Ñ–æ—Ä–º–∏—Ä—É—è –º—ã—à–ª–µ–Ω–∏–µ –±—É–¥—É—â–∏—Ö –ø–æ–∫–æ–ª–µ–Ω–∏–π.",
        "–ø–∏—Å–∞—Ç–µ–ª—å": "–ü–∏—Å–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞–≤–∞–ª–∏ –∫–Ω–∏–≥–∏, –ø—å–µ—Å—ã, –≤–¥–æ—Ö–Ω–æ–≤–ª—è–ª–∏ –ª—é–¥–µ–π. –ò—Ö —Å–ª–æ–≤–∞ –∏–º–µ–ª–∏ —Å–∏–ª—É –º–µ–Ω—è—Ç—å –æ–±—â–µ—Å—Ç–≤–æ.",
        "—à–∞—Ö—Ç—ë—Ä": "–®–∞—Ö—Ç—ë—Ä—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –≤ —Ç—è–∂–µ–ª–µ–π—à–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö, –¥–æ–±—ã–≤–∞—è —É–≥–æ–ª—å –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è —Å—Ç—Ä–∞–Ω—ã.",
        "–∞—Ä—Ç–∏—Å—Ç": "–ê—Ä—Ç–∏—Å—Ç—ã –≤—ã—Å—Ç—É–ø–∞–ª–∏ –Ω–∞ —Å—Ü–µ–Ω–∞—Ö, –≤–¥–æ—Ö–Ω–æ–≤–ª—è—è –∏ –æ–±—ä–µ–¥–∏–Ω—è—è –ª—é–¥–µ–π –¥–∞–∂–µ –≤ —Å–∞–º—ã–µ —Ç—Ä—É–¥–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞.",
        "–≤–æ–µ–Ω–Ω—ã–π": "–í–æ–µ–Ω–Ω—ã–µ –∑–∞—â–∏—â–∞–ª–∏ –†–æ–¥–∏–Ω—É –∏ —Å—Ç—Ä–æ–∏–ª–∏ –≤–æ–µ–Ω–Ω—É—é –º–æ—â—å –°–°–°–†.",
        "—É—á—ë–Ω—ã–π": "–£—á—ë–Ω—ã–µ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏ –Ω–æ–≤–µ–π—à–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è, –ø—Ä–æ–¥–≤–∏–≥–∞—è –Ω–∞—É–∫—É —Å—Ç—Ä–∞–Ω—ã –≤–ø–µ—Ä—ë–¥.",
        "–ø–∞—Ä—Ç–∏–π–Ω—ã–π –¥–µ—è—Ç–µ–ª—å": "–≠—Ç–∏ –ª—é–¥–∏ –æ–ø—Ä–µ–¥–µ–ª—è–ª–∏ –∫—É—Ä—Å —Å—Ç—Ä–∞–Ω—ã –∏ —É–ø—Ä–∞–≤–ª—è–ª–∏ –µ—ë —Ä–∞–∑–≤–∏—Ç–∏–µ–º.",
        "–∏–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å": "–ò–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª–∏ –Ω–∞—Ö–æ–¥–∏–ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ —Å–æ–∑–¥–∞–≤–∞–ª–∏ –Ω–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã.",
        "—Ñ–∞–±—Ä–∏—á–Ω—ã–π —Ä–∞–±–æ—á–∏–π": "–û—Å–Ω–æ–≤–Ω–∞—è –¥–≤–∏–∂—É—â–∞—è —Å–∏–ª–∞ –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –°–°–°–†.",
        "–∫–æ–ª—Ö–æ–∑–Ω–∏–∫": "–†–∞–±–æ—Ç–Ω–∏–∫–∏ —Å–µ–ª—å—Å–∫–æ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º —Å—Ç—Ä–∞–Ω—É.",
        "–º–∏–ª–∏—Ü–∏–æ–Ω–µ—Ä": "–û—Ö—Ä–∞–Ω—è–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –∏ –∑–∞—â–∏—â–∞–ª–∏ –≥—Ä–∞–∂–¥–∞–Ω.",
        "–ª—ë—Ç—á–∏–∫": "–ü–∏–ª–æ—Ç—ã –ø–æ–∫–æ—Ä—è–ª–∏ –Ω–µ–±–æ, –¥–æ—Å—Ç–∞–≤–ª—è—è –≥—Ä—É–∑—ã –∏ —Å—Ä–∞–∂–∞—è—Å—å –∑–∞ —Å—Ç—Ä–∞–Ω—É.",
        "–¥–∏–ø–ª–æ–º–∞—Ç": "–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–∏ —Å—Ç—Ä–∞–Ω—ã –Ω–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π –∞—Ä–µ–Ω–µ, –æ—Ç–≤–µ—á–∞—é—â–∏–µ –∑–∞ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã –∏ —Å–≤—è–∑–∏.",
        "–≤—Ä–∞—á": "–°–ø–∞—Å–∞–ª–∏ –∂–∏–∑–Ω–∏, –ª–µ—á–∏–ª–∏ –±–æ–ª–µ–∑–Ω–∏ –∏ —Å—Ç–æ—è–ª–∏ –Ω–∞ —Å—Ç—Ä–∞–∂–µ –∑–¥–æ—Ä–æ–≤—å—è –Ω–∞—Ü–∏–∏."
    }
    text = f"üîé –¢—ã ‚Äî {top_prof.title()}!

üìú {history.get(top_prof, '–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –ø—Ä–æ—Ñ–µ—Å—Å–∏—è XX –≤–µ–∫–∞!')}"
    await bot.send_message(user_id, text, reply_markup=types.ReplyKeyboardRemove())

if __name__ == '__main__':
    executor.start_polling(dp)
